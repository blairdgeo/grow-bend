<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8' />
        <title>Layers of NYC. Explore the structure of Manhattan’s urban fabric. | MORPHOCODE</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <script src='lib/mapbox-gl-js/dist/mapbox-gl-dev.js'></script>
        <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.2.2/mapbox-gl.css' rel='stylesheet' />

        <script src="lib/d3js/d3.js"></script>
        <script src="lib/jquery/jquery-2.1.1.min.js"></script>
        <script src="lib/jquery/jquery-ui-draggable.min.js"></script>
        <script src="lib/jquery/jquery.cookie.min.js"></script>

        <script src="lib/intro-js/intro.js"></script>
        <link href='lib/intro-js/introjs.css' rel='stylesheet' />

        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
        <link rel="stylesheet" href="lib/bootstrap/lumen.bootstrap.min.css">
        <script src="lib/bootstrap/bootstrap.min.js"></script>

        <script src="js/namespace.js"></script>
        <script src="js/timeline.js"></script>
        <script src="js/mapgl.js"></script>
        <script src="js/ui.js"></script>
        <script src="js/util.js"></script>

        <link href='style/city-layers.css' rel='stylesheet' />

        <link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
        <style type="text/css">
            #mc_embed_signup form {
                padding: 0;
            }
            #mc_embed_signup input.email {
                width: 70%;
                height: 40px;
                float: left;
            }
            #mc_embed_signup input.button {
                clear: none;
                float: left;
                height: 40px;
                width: 20%;
            }
        </style>

        <script>
            $().ready(function() {
                if (getParameterByName("show") != "true") {
                    $("body").html("Under Construction");
                }

                // build the buttons
                urbanmap.ui.build();
                urbanmap.ui.timeline.build();
                // the tour has to be built after the timeline, in order for selectors to work
                // or use custom intro.onbeforechange callback
                urbanmap.ui.buildTour();

                // welcome the User
                urbanmap.ui.welcome();

            });

        </script>

    </head>

    <body>

        <div id="map"></div>
        <div id="map-controls"></div>

        <nav class="navbar navbar-inverse" role="navigation">
          <div class="container-fluid">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="#" id="btn-home">Morphocode</a>
            </div>

            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav">
                <li class="explore-menu dropdown hidden-md">
                  <a href="#" data-toggle="dropdown">Explore <span class="caret"></span></a>
                  <ul class="dropdown-menu" role="menu">
                    <li><a id="layer-oldest-buildings" href="#">The 100 oldest buildings</a></li>
                    <li class="divider"></li>
                    <li><a id="layer-most-buildings" href="#">The most build-intense decade</a></li>
                    <li class="divider"></li>
                    <li><a id="layer-newest-buildings" href="#">The newest buildings in Manhattan</a></li>
                  </ul>
                </li>
                <li><a href="#" class="btn-about hidden-md">About</a></li>
                <li><a href="#" class="btn-learn">Learn</a></li>
                <li><a href="#" class="btn-team">Team</a></li>
                <li><a id="help-button" href="#">Help</a></li>
                <li class="share-menu-item"><a id="help-button" href="#">Share:</a></li>
                <li class="share-buttons">
                    <div class="addthis_toolbox addthis_default_style addthis_16x16_style">
                        <a class="addthis_button_facebook"></a>
                        <a class="addthis_button_twitter"></a>
                        <a class="addthis_button_compact"></a>
                    </div>
                </li>
                <li class="follow-buttons">
                    <a class="addthis_button_twitter_follow_native" tw:screen_name="morphocode"></a>
                </li>

              </ul>
              <ul class="nav navbar-nav navbar-right">
                <li><a id="button-project-of" href="#">A project by:</a></li>
                <li><a id="btn-morphocode" href="http://morphocode.com/about/" target="_blank"><img src="images/morphocode-logo.jpg" /></a></li>
              </ul>
            </div>

          </div>
        </nav>

        <!-- wraps content part -->
        <div id="content-wrapper">

            <!-- Welcome Screen -->
            <div id="welcome" class="content-page">
                <div class="row-wrapper">
                    <div id="welcome-header">
                        <div class="container">
                                <div class="row">
                                    <div class="col-md-12">
                                            <h1>Layers of NYC</h1>
                                            <h2>Explore the structure of Manhattan’s urban fabric.</h2>
                                            <button type="button" class="btn btn-primary btn-xlarge" id="btn-explore">Explore</button>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="row-wrapper">
                    <div id="welcome-details">
                        <div class="container">
                                <div class="row">
                                    <div class="col-md-4 info">
                                        <i class="fa fa-map-marker lead-icon"></i>
                                        <h3>About</h3>
                                        <p>
                                            Layers of NYC is an interactive map created by Morphocode that explores the structure of Manhattan’s urban fabric.
                                        </p>
                                        <p class="more">
                                            <a class="btn-about" href="#">Read More <i class="fa fa-angle-right"></i> </a>
                                        </p>
                                    </div>
                                    <div class="col-md-4 info">
                                        <i class="fa fa-graduation-cap lead-icon"></i>
                                        <h3>Learn</h3>
                                        <p>
                                            We’ve used Mapbox GL, d3.js and data from PLUTO to show dynamically more than 45 000 buildings.
                                        </p>
                                        <p class="more">
                                            <a class="btn-learn" href="#">Learn How it Works <i class="fa fa-angle-right"></i> </a>
                                        </p>
                                    </div>
                                    <div class="col-md-4 info">
                                        <i class="fa fa-circle-o lead-icon"></i>
                                        <h3>Team</h3>
                                        <p>
                                            Morphocode is an Architectural Practice working at the Intersection of Design and Technology.
                                        </p>
                                        <p class="more">
                                            <a class="btn-team" href="#">Visit Us <i class="fa fa-angle-right"></i> </a>
                                        </p>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- About the Project ======================================= -->
            <div id="about" class="content-page">
                <div class="section blue layers-of-architecture">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <h1>About</h1>
                                <blockquote id="koolhaas-quote">
                                "...each block is covered with several layers of phantom architecture in the form of past occupancies, aborted projects and popular fantasies that provide alternative images to the New York that exists."
                                <footer>
                                Rem Koolhaas, "Delirious New York"
                                </footer>
                                </blockquote>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section about-the-project">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <h2>The Project</h2>

                                <p>
                                    <a href="http://io.morphocode.com/urban-layers/nyc.htm">Layers of NYC</a> is an interactive visualization created by <a href="http://morphocode.com/about/" target="_blank">Morphocode</a> that explores the structure of Manhattan's urban fabric.
                                <p>
                                The map lets you navigate through historical fragments of the city that have been preserved and are now embedded in Manhattan's densely built environment. The rigid archipelago of building blocks has been mapped as a succession of structural episodes starting from 1765.
                                </p>

                                <p>
                                Use the timeline sliders to identify some of Manhattan's oldest buildings; discover how the beginning of the 20th century marked the island skyline or to define the distribution of building activity over the last decades.
                                </p>

                                <p>
                                <a href="#" id="how-it-s-made">How it's made?</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section gray">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <h2>Press Downloads</h2>
                                <p>
                                The material on this web site can be used freely in any publication provided that it is duly credited as a project by <a href="http://morphocode.com/" target="_blank">Morphocode</a>.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section subscribe">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <h2>Subscribe for Updates</h2>
                                <div id="mc_embed_signup">
                                    <form action="//morphocode.us9.list-manage.com/subscribe/post?u=92a85e8e154b24ed522605326&amp;id=c08f455190" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                                        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
                                        <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                                        <div style="position: absolute; left: -5000px;"><input type="text" name="b_92a85e8e154b24ed522605326_c08f455190" tabindex="-1" value=""></div>
                                        <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section gray technical-development">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <h2>The Making Of</h2>
                                <p>The basis of <strong>Layers of NYC</strong> is the <a href="http://www.codeforamerica.org/blog/2013/07/25/epic-win-for-nycs-open-data-community-pluto-is-free/">PLUTO</a> data set. It was released to the public in 2013 and contains information about the age of NYC's buildings. Each building is identified by it's unique number - the BIN.
                                </p>
                                <p>
                                The building footprints were obtained from the <a href="https://data.cityofnewyork.us/">NYC Open Data portal</a> in the form of a shape file. We then imported the file into a <a href="http://postgis.net/">PostGIS</a> database using <a href="http://suite.opengeo.org/4.1/dataadmin/pgGettingStarted/shp2pgsql.html">shp2pgsql</a>.
                                Each building footprint is matched to a row in the PLUTO database by BIN.
                                </p>
                                <p>Since PLUTO is missing a BIN column, the PAD database is used as an intermediate step - approach described by <a href="http://bdon.org/">Brandon Liu</a>. The two databases are matched against each other by 3 fields: borocode, block and lot. This approach allows us to match around 90% of the footprints to their corresponding rows in PLUTO. The other 10% of the buildings are left unmatched due to missing or invalid information in the PAD database. These buildings are shown in gray on the map.
                                </p>
                                <p>There are more than 1 000 000 buildings in NYC. This prooved to be too much to display at once, se we've selected only the buildings that are located in Manhattan. Manhattan alone contains more than 40 000 buildings.
                                </p>
                                <p>Displaying big data in the browser is not easy. There are three standard solutions: <strong>raster tiles, svg and canvas:</strong>.
                                </p>
                                <p> <strong>Raster map tiles</strong> are good for static maps with basic mouse-over interactivity. It was clear, that they are not a good fit for the high interactivity required in Layers of NYC.
                                </p>
                                <p><strong>SVGs</strong> are a good choice: d3.js is based on SVG and has a nice <a href="https://github.com/mbostock/d3/wiki/Geo-Projections">support for geo data</a>. <a href="http://leafletjs.com/">Leaflet.js</a> provides support for vector layers based on SVG/Canvas. A typical solution would be to convert the NYC footprints to GeoJSON and show them on a map. Unfortunately, it turned out that the performance with so many polygons is not that good.
                                </p>
                                <p><strong>HTML5 Canvas</strong> is usually performing well. CartoDB have successfully used canvas in the great Torquee library. Unfortunately most of the solutions, we've found draw dots, not polygons.
                                </p>
                                <p>As you probably have guessed, there's only one viable option left - <strong>WebGL</strong>.
                                </p>
                                <p>
                                Meet <strong>Mapbox GL</strong> - a project recently announced by Mapbox. It uses WebGL to display maps in the browser. Since it's using your video card, the performance is great. The only downside is that it's only supported in Chrome and Firefox on the desktop. IE9+ support is coming.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section attribution">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <h2>Attribution</h2>
                                <ul class="attribution">
                                    <li><strong>Data: </strong> Pluto Data Set provided by Department of City Planning (DCP)</li>
                                    <li><strong>Basemap: </strong> <a href="http://www.arcgis.com/home/item.html?id=ed712cb1db3e4bae9e85329040fb9a49" target="_blank">Light Gray Canvas Map</a>, Sources: Esri, HERE, DeLorme, MapmyIndia, © OpenStreetMap contributors, and the GIS user community </li>
                                    <li><strong>UI Controls: </strong> The graph and the sliders were built using the great <a href="http://d3js.org/" target="_blank">d3.js</a> library. </li>
                                    <li><strong>Map UI: </strong> We used the ultra impressive <a href="https://www.mapbox.com/mapbox-gl/"> Mapbox GL JS</a> library to draw the large amount of buildings and to show/hide the layers.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Learn =============================================================== -->
            <div id="learn" class="content-page">
                <div class="section section-learn">
                    <div class="row">
                        <div class="col-md-8 col-md-offset-2">
                            <h1>How it works?</h1>
                            <h2>Urban Planners, Civil Hackers, Map Makers -That’s for you!</h2>
                            <img src="images/making-of-diagram.png" width="100%"/>
                            <div class="buttons">
                                <button type="button" class="btn btn-primary btn-xlarge">Read Full Story</button>
                                <button type="button" class="btn btn-default btn-xlarge">Take the Course</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="team" class="content-page">
                <div class="section section-team">
                    <div class="row">
                        <div class="col-md-4 col-md-offset-4">
                            <h1>The Team</h1>
                            <h2>Morphocode is an Architectural Practice working at the Intersection of Design and Technology.</h2>
                            <div class="buttons">
                                <a href="http://morphocode.com/about/" target="_blank" class="btn btn-primary btn-xlarge">Visit us</a>
                                <a href="http://morphocode.com/contact/" target="_blank" class="btn btn-default btn-xlarge">Contact</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div><!--content wrapper -->


    <!-- share buttons -->
    <script type="text/javascript">
        var addthis_config = {
            "data_track_clickback": false
        };
        var addthis_share =
        {
           templates: {
                twitter: 'Check out {{url}} via @morphocode'
           }
        };
    </script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50c5d7cd149035aa"></script>

    <!-- analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-20080950-1', 'auto');
        ga('send', 'pageview');

    </script>


    </body>
</html>
